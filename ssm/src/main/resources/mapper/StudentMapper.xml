<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.google.ssm.dao.StudentDao">

    <resultMap id="studentMap" type="student">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="age" property="age"/>
        <association property="clazz" javaType="class">
            <!--<id column="id" property="id"/>-->
            <result column="className" property="name"/>
        </association>
        <collection property="teachers" ofType="teacher">
            <!--<id column="id" property="id"/>-->
            <result column="teacherName" property="name"/>
        </collection>
    </resultMap>


	<select id="queryStudentDetail" resultMap="studentMap">
        SELECT
            s.*, t.`name` AS teacherName,
            c.`name` AS className
        FROM
            student s
        LEFT JOIN student_teacher st ON s.id = st.student_id
        LEFT JOIN teacher t ON st.teacher_id = t.id
        LEFT JOIN student_class scc ON scc.student_id = s.id
        LEFT JOIN class c ON scc.class_id = c.id
    </select>

    <update id="updateStudent" parameterType="student">
        update student set name = #{name} where 1=1 and id = #{id}
    </update>
</mapper>
